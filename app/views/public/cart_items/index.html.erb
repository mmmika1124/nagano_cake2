<h1>ショッピングカート</h1>
<%= link_to "カートを空にする", model: @cart_items, url: cart_items_destroy_all_path, method: :DELETE, data: {confirm: "本当に退会しますか？"} %>
<br>
<table>
  <thead>
    <tr>
      <th>商品名</th>
      <th>単価（税込）</th>
      <th>数量</th>
      <th>小計</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @cart_items. each do |cart_item| %>
      <tr>
        <td>
          <%= attachment_image_tag cart_item.item, :image, format: 'jpg', size: "50x50" %>
          <%= cart_item.item.name %>
        </td>
        <td><%= ((cart_item.item.price*1.1).floor).to_s(:delimited) %></td>
        <td>
          <%= form_with model:@cart_item, url:cart_item_path(cart_item.id), method: :PATCH, local: true do |f| %>
            <%= f.select :amount, *[1..5] %>
            <%= f.submit "変更" %>
          <% end %>
        </td>
        <td><%= (((cart_item.item.price * cart_item.amount)*1.1).floor).to_s(:delimited) %></td>
        <td></td>
      </tr>
    <% end %>
  </tbody>
</table>
